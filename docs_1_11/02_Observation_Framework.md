# 模块详解二：观测管理器 (Observation Manager)

> **目标**：理解机器人的“眼睛”和“感知系统”。它是怎么感知世界的？

## 1. 什么是观测 (Observation)？

对于人类来说，我们通过眼睛看路，通过内耳的前庭保持平衡，通过皮肤感受脚底的压力。
对于机器人，**观测（Observation）就是一串数字数组**。每一帧，环境都会把这串数字喂给神经网络。

在 `ObservationsCfg` 类中，我们将观测分为两类：**策略观测 (Policy)** 和 **特权观测 (Critic)**。这是一种非常流行的“教师-学生”训练模式。

## 2. 策略观测 (Policy Inputs) - 学生的视角

这是机器人实际在运行（部署）时能拿到的数据。它模拟了真实传感器的数据，所以是不完美的。

### 2.1 核心感知项
*   **`base_ang_vel` (基座角速度)**: 
    *   *含义*：身体旋转得有多快？
    *   *作用*：防止摔倒，保持平衡。
*   **`proj_gravity` (重力投影)**: 
    *   *含义*：身体倾斜了多少？（比如重力本来是垂直向下的，如果身体歪了，传感器测到的重力分量就会变）。
    *   *作用*：这是机器人知道自己“哪边是上，哪边是下”的唯一依据。
*   **`joint_pos` & `joint_vel` (关节位置与速度)**:
    *   *含义*：当前的腿伸到哪里了？动得有多快？
    *   *作用*：本体感知。

### 2.2 为什么要加噪声 (Noise)？
你会发现代码里到处都有 `GaussianNoise`：

```python
noise=GaussianNoise(mean=0.0, std=0.05)
```

**纯小白解释**：
仿真器是完美的，数据是 100% 准确的。但现实世界的传感器（几十块钱的 IMU 说不定）是有误差的，会抖动。
如果在完美的数据上训练，机器人到了现实世界，只要传感器有一点误差，它就傻了。
所以我们在仿真里**故意加捣乱的噪声**，强迫机器人学会透过干扰看本质。这就叫 **Sim-to-Real（仿真到现实）** 的鲁棒性训练。

### 2.3 极简主义设计：Gait Frequency Only
在这一版代码中，有一个针对任务的特殊优化：

```python
# 只保留步态频率，而不是完整的4维步态命令
gait_frequency = ObsTerm(func=get_gait_frequency_only, ...)
```

原本的步态命令包含频率、相位、偏移等很多参数。但在这个任务中，我们为了让机器人学得更快，只告诉它**“踏步的频率是多少”**。这就像教人跳绳，先把“节奏”这一件事练好，不要给大脑塞太多无关信息。

## 3. 特权观测 (Critic Inputs) - 老师的上帝视角

这是只有在训练阶段，评价网络（Critic/老师）能看到，但策略网络（Policy/学生）看不到的数据。

*   **`base_lin_vel` (真实线速度)**: 机器人在现实中很难直接测准自己的绝对速度（就像人在溜冰场很难知道自己滑多快）。但在仿真里，老师知道得一清二楚。
*   **`robot_feet_contact_force` (精确的足部接触力)**: 老师知道脚踩地踩得有多实。
*   **物理参数**: 此时此刻机器人的摩擦力是多少、质量是多少。

**为什么这样设计？**
老师（Critic）利用这些完美信息来给学生（Policy）打分，指导学生学习。虽然学生在考场上（部署时）看不到标准答案，但在平时的练习中，老师的指导会让它逐渐逼近标准答案。
